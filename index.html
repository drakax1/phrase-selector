<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Sélection de Phrases</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      display: flex;
    }

    .container, .output-container {
      width: 50%;
      padding: 20px;
    }

    .output-container {
      border-left: 2px solid #ccc;
    }

    .output {
      margin-top: 20px;
      padding: 10px;
      border: 1px solid #ccc;
      min-height: 100px;
      background: #f9f9f9;
      transition: background 0.3s ease;
      white-space: pre-line;
    }

    button {
      margin-top: 10px;
      cursor: pointer;
    }

    .copied {
      background: #d4edda;
    }

    .sortable-list {
      list-style: none;
      padding: 0;
    }

    .sortable-item {
      padding: 8px;
      border: 1px solid #ccc;
      margin: 5px 0;
      background: white;
      cursor: grab;
    }

    /* Nouveau style pour un alignement propre */
    .phrase-label {
      display: grid;
      grid-template-columns: auto 35px 1fr;
      align-items: start;
      column-gap: 8px;
      margin-bottom: 6px;
    }

    .phrase-label input {
      margin: 0;
    }

    .phrase-label .num {
      text-align: right;
      padding-top: 2px; /* Pour forcer l’alignement haut */
    }
  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.14.0/Sortable.min.js"></script>
</head>
<body>
  <div class="container">
    <h3>Choisissez vos phrases :</h3>
    <p id="count">0 phrase sélectionnée</p>
    <div id="checkboxes">
      <!-- Phrases générées dynamiquement pour clarté -->
    </div>
  </div>

  <div class="output-container">
    <h3>Phrases sélectionnées :</h3>
    <ul id="output" class="sortable-list"></ul>
    <button onclick="copyText()">Copier le texte</button>
  </div>

  <script>
    const phrases = [
      "Analyse du cheminement",
      "Pose de postes d’appâtage sécurisés avec appâts intégrés",
      "Pose d’un système de piégeage avec attractants intégrés",
      "Relevage du système de piégeage",
      "Contrôle de la consommation des appâts à l’intérieur des postes sécurisés",
      "Ré-approvisionnement en appâts des postes sécurisés",
      "Obturation du/des passages à l’aide de treillis",
      "Obturation du/des passages à l’aide d’une mousse spécifique",
      "Injection de poudre répulsive",
      "Injection de poudre insecticide",
      "Pose de points de gel insecticide",
      "Pose de boîtes avec gel insecticide intégré",
      "Pose de granulés insecticide",
      "Pulvérisation d’un produit insecticide à longue rémanence",
      "Pulvérisation d’un produit insecticide à effet choc",
      "Elimination du nid",
      "Pose de piège avec attractant intégré",
      "Triage des denrées alimentaires sèches"
    ];

    const checkboxContainer = document.getElementById('checkboxes');

    phrases.forEach((text, index) => {
      const label = document.createElement('label');
      label.classList.add('phrase-label');

      const checkbox = document.createElement('input');
      checkbox.type = 'checkbox';
      checkbox.classList.add('phrase');
      checkbox.value = `- ${text}`;

      const num = document.createElement('span');
      num.classList.add('num');
      num.textContent = `${(index + 1).toString().padStart(2, '0')}.`;

      const phraseSpan = document.createElement('span');
      phraseSpan.textContent = text;

      label.appendChild(checkbox);
      label.appendChild(num);
      label.appendChild(phraseSpan);

      checkboxContainer.appendChild(label);
    });

    function updateText() {
      let outputList = document.getElementById('output');
      outputList.innerHTML = '';
      let selectedCheckboxes = document.querySelectorAll('.phrase:checked');
      selectedCheckboxes.forEach(cb => {
        let li = document.createElement('li');
        li.textContent = cb.value;
        li.classList.add('sortable-item');
        outputList.appendChild(li);
      });
      updateCount(selectedCheckboxes.length);
    }

    function updateCount(count) {
      document.getElementById('count').textContent = `${count} phrase${count > 1 ? 's' : ''} sélectionnée${count > 1 ? 's' : ''}`;
    }

    document.addEventListener('change', function (e) {
      if (e.target.classList.contains('phrase')) {
        updateText();
      }
    });

    function copyText() {
      let text = Array.from(document.querySelectorAll('#output .sortable-item'))
                      .map(li => li.textContent).join('\n');
      navigator.clipboard.writeText(text)
        .then(() => alert("Texte copié !"))
        .catch(() => alert("Erreur lors de la copie !"));
    }

    document.addEventListener("DOMContentLoaded", function() {
      new Sortable(document.getElementById('output'), {
        animation: 150,
        ghostClass: 'sortable-ghost'
      });
    });
  </script>
</body>
</html>
